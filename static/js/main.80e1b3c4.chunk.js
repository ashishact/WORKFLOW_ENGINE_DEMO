(this.webpackJsonpworkflow_frontend=this.webpackJsonpworkflow_frontend||[]).push([[0],{42:function(e,n,t){},44:function(e,n,t){},79:function(e,n,t){"use strict";t.r(n);var a,r=t(1),i=t.n(r),s=t(35),o=t.n(s),u=(t(42),t(6)),l=t.n(u),c=t(10),d=t(5),p=(t(44),t(18)),m=t(17),h=t.n(m),f=t(2);t(37),t(36);!function(e){e.success="success",e.fail="fail"}(a||(a={}));var v=f.union([f.literal("WorkflowExecutionStarted"),f.literal("WorkflowTaskScheduled"),f.literal("WorkflowTaskStarted"),f.literal("WorkflowTaskCompleted"),f.literal("ActivityTaskScheduled"),f.literal("ActivityTaskStarted"),f.literal("ActivityTaskCompleted"),f.literal("WorkflowExecutionCompleted"),f.literal("WorkflowTaskFailed"),f.literal("ERROR")]),y=f.type({eventTime:f.string,eventType:v,eventId:f.string,details:f.any}),w=(f.type({rawHistory:f.array(f.unknown),history:f.type({events:f.array(y)})}),f.type({pendingActivities:f.array(f.type({activityId:f.string,activityType:f.type({name:f.string}),state:f.string,attempt:f.number,maximumAttempts:f.number,lastFailure:f.union([f.null,f.type({message:f.string,source:f.string})]),scheduledTime:f.union([f.string,f.null])})),workflowExecutionInfo:f.type({startTime:f.string,closeTime:f.union([f.string,f.null]),status:f.string,historyLength:f.string,executionTime:f.string})}),[]);w.push({name:"01 - Hello World",code:'\n# 01 - Hello World\n---\nname: "Hello World"\nmain:\n  step_one: \n    return: "Hello World"\n'}),w.push({name:"02 - Call a activity",code:'\n# 02 - Call a activity\n---\nname: "Sleep"\nmain:\n  step_one: \n    call: sleep\n    args:\n      seconds: 4\n'}),w.push({name:"03 - Http Get",code:"\n# 03 - Http Get\n---\nmain:\n  getDayOfWeek:\n    call: http.get\n    args:\n      url: http://worldclockapi.com/api/json/est/now\n    result: currentTime\n    return: currentTime.dayOfTheWeek\n"}),w.push({name:"04 - Assign Variable",code:'\n# 04 - Assign Variable\nname: "Assign Variable"\nmain:\n  step_one:\n    assign:\n      value1: 5\n      value2: value1 + 3\n      value3: "sum of all = "\n    return: value3 + value2\n'}),w.push({name:"05 - Expression in Arguments",code:'\n# 05 - Expression in Arguments\nname: "Expression in arguments"\nmain:\n  step_zero:\n    assign:\n      key: "6132d68042e14b1f87e190827210306"\n      city: "Tokyo"\n\n  step_two_getWeather:\n    call: http.get\n    args:\n      url: http://api.weatherapi.com/v1/current.json?key=${key}&q=${city}\n    result: weather\n    return: Temperature in ${city} is ${weather.current.temp_c} deg celcius\n'}),w.push({name:"06 - Switch Condition",code:'\n# 06 - Switch Condition\nname: "Jump based on switch condition"\nmain:\n    getCurrentTime:\n        call: http.get\n        args:\n            url: https://us-central1-workflowsample.cloudfunctions.net/datetime\n        result: currentTime\n    conditionalSwitch:\n        switch:\n            - condition: currentTime.dayOfTheWeek == "Monday"\n              next: monday\n            - condition: currentTime.dayOfTheWeek == "Tuesday"\n              next: tuesday\n            - condition: currentTime.dayOfTheWeek == "Wednesday"\n              next: wednesday\n            - condition: currentTime.dayOfTheWeek == "Thursday"\n              next: thursday\n            - condition: currentTime.dayOfTheWeek == "Friday"\n              next: friday\n            - condition: currentTime.dayOfTheWeek == "Saturday" || currentTime.dayOfTheWeek == "Sunday"\n              next: weekend\n        next: noday\n    monday:\n        return: "It\'s Monday. Make cookies with a smiley faces."\n    tuesday:\n        return: "It\'s Tuesday. There\u2019s no need to have Pokemon Go, wear a Pikachu pyjamas."\n    wednesday:\n        return: "It\'s Wednesday. When on a stroll, jump for a photo shot."\n    thursday:\n        return: "It\'s Thursday. Don\u2019t miss the fun even when you are alone, watch a comedy."\n    friday:\n        return: "It\'s Friday! Almost the weekend!. Don\u2019t let the rain spoils your fun, have an indoor picnic."\n    weekend:\n        return: "It\'s the weekend!. Do whatever you want"\n    noday:\n        return: "I have no idea what day it is"\n'}),w.push({name:"07 - Match",code:'\n# 07 - Match\nname: "Expression in arguments"\nmain:\n  step_zero:\n    assign:\n      key: "6132d68042e14b1f87e190827210306"\n      city: "Tokyo"\n\n  step_two_getWeather:\n    call: http.get\n    args:\n      url: http://api.weatherapi.com/v1/current.json?key=${key}&q=${city}\n    result: weather\n  \n  step_three:\n    match:\n      on: weather.current.temp_c\n      conditions:\n        - (t = )\n'}),w.push({name:"08 - Match Expression",code:'\n# 08 - Match Expression\n---\nname: "Match Expression"\nmain:\n  step_zero:\n    call: http.get\n    args:\n      url: http://worldclockapi.com/api/json/est/now\n    result: currentTime\n        \n  step_one: \n    match: \n      on: currentTime.dayOfTheWeek\n      conditions:\n        -  (b = "Thursday") => value = \'Yo! Thursday\'\n        -  (d = "Monday")   => value = \'Monday\'\n        -  (x)              => value = "Unknown Day"\n  step_two:\n    return: value\n'}),w.push({name:"08 - Match Expression Tail",code:"\n# 08 - Match Expression Tail\n---\nname: \"Match Expression Tail\"\nmain:\n  step_two:\n    assign:\n        person: { name: 'Maria'}\n        ages: [24, 25, 26, 27, 28]\n    match:\n        on: ages\n        conditions:\n            - (x = person)      => value = 1\n            - (a1, a2, rest)    => value = rest\n    return: value\n"}),w.push({name:"03 - Check If Valid Date",code:'\n# 03 - Check If Valid Date\n---\nmain:\n    getDayOfWeek:\n        call: http.get\n        args:\n            url: http://worldclockapi.com/api/json/est/now\n        result: currentTime\n    check:\n        match:\n            on: new Date(currentTime.currentDateTime)\n            conditions:\n                - (d = Date) => value = d\n                - (x)        => value = false\n        return: value\n    step3:\n        switch:\n            - condition: value\n              next: date\n        next: nodate\n    date:\n        return: "Yes it\'s a date"\n    nodate:\n        return: "Not a date"\n'}),w.push({name:"02 - Timeout",code:'\n# 02 - Timeout\n---\nname: "Sleep"\ntimeout: 5\nmain:\n  step_one: \n    call: sleep\n    args:\n      seconds: 10\n'}),w.push({name:"- Retry whne service unavailable",code:"\n# - Retry whne service unavailable\n"});var g,T={yamls:w},k=t(23),b=t(20),x=t.n(b),O=t(3),N=function(e){var n=e.history,t=e.status,a=Object(r.useRef)(null),i="START LOGS\n",s=function(e){if(!n)return null;var t=null;return n.history.events.find((function(n){var a,r;if(n.eventId===e&&"ActivityTaskScheduled"===n.eventType&&(t=null===(a=n.details)||void 0===a||null===(r=a.input)||void 0===r?void 0:r.payloads))return!0})),t};if(t){var o;if(null===(o=t.pendingActivities)||void 0===o?void 0:o.length){var u,l="",c=Object(k.a)(t.pendingActivities);try{for(c.s();!(u=c.n()).done;){var d,m,h=u.value;l+="PENDING => "+JSON.stringify({Name:null===(d=h.activityType)||void 0===d?void 0:d.name,scheduledTime:h.scheduledTime,lastFailure:{message:null===(m=h.lastFailure)||void 0===m?void 0:m.message},attempt:h.attempt,maximumAttempts:h.maximumAttempts},null,2)+"\n"}}catch(_){c.e(_)}finally{c.f()}l&&(i+=l)}if(t.workflowExecutionInfo){i+="\n\n=======================\n";var f=t.workflowExecutionInfo,v={executionTime:f.executionTime,status:f.status.toUpperCase(),startTime:f.startTime,closeTime:f.closeTime};i+="EXECUTION INFO => "+JSON.stringify(v,null,2)}}if(i+="\n=======================\n\n",n){var y,w=Object(k.a)(n.history.events);try{for(w.s();!(y=w.n()).done;){var g=y.value,T=null;if("ActivityTaskStarted"===g.eventType){T=x()(g.eventTime).format("YY MMM DD, HH:mm:ss")+" : [ActivityStarted] => ";var b=s(g.details.scheduledEventId);if(b){Array.isArray(b)&&b.length&&(b=b[0]);var N=b,j=N.Name,E=N.Call,I=N.Result,S=N.Return;T+=JSON.stringify({Name:j,Call:E,Result:I,Return:S},null,2)+"\n"}else T+=JSON.stringify(g,null,2)+"\n"}else if("ActivityTaskCompleted"===g.eventType){T=x()(g.eventTime).format("YY MMM DD, HH:mm:ss")+" : [ActivityCompleted] => ";var M=s(g.details.scheduledEventId);if(M){var A,R;Array.isArray(M)&&M.length&&(M=M[0]),M={Name:M.Name,Call:M.Call,Result:null===(A=g.details)||void 0===A||null===(R=A.result)||void 0===R?void 0:R.payloads};try{var C=JSON.parse(M.Result);M.Result=C}catch(L){}T+=JSON.stringify(M,null,2)+"\n"}else T+=JSON.stringify(g,null,2)+"\n"}else if("WorkflowExecutionCompleted"===g.eventType){var D,W;T=x()(g.eventTime).format("YY MMM DD, HH:mm:ss")+" : [WorkflowExecutionCompleted] => ";var F=null===(D=g.details)||void 0===D||null===(W=D.result)||void 0===W?void 0:W.payloads;T+=F?JSON.stringify({result:F},null,2)+"\n":JSON.stringify(g,null,2)+"\n"}T&&(i+=T+"\n")}}catch(_){w.e(_)}finally{w.f()}}return t&&(i+="\n\n=======================\n",i+="FULL STATUS => "+JSON.stringify(t,null,2)),n&&(i+="\n\n=======================\n",i+="FULL HISTORY => ",i+=JSON.stringify(n,null,2)),a.current&&a.current.setValue(i),Object(O.jsx)(p.a,{width:"100%",theme:"vs-dark",height:"100vh",options:{minimap:{enabled:!1},lineNumbers:"off",readOnly:!0,scrollbar:{vertical:"hidden"}},defaultLanguage:"typescript",defaultValue:i,onMount:function(e,n){a.current=e}})},j=console.warn,E=console.log,I="http://13.127.17.219:3014/api/v1";!function(e){e[e.NONE=0]="NONE",e[e.RUNNING=1]="RUNNING",e[e.FAILED=2]="FAILED",e[e.COMPLETED=3]="COMPLETED",e[e.TERMINATED=4]="TERMINATED"}(g||(g={}));var S=g.NONE;var M=function(){var e=Object(r.useRef)(null),n=Object(r.useState)(null),t=Object(d.a)(n,2),i=t[0],s=t[1],o=Object(r.useState)(null),u=Object(d.a)(o,2),m=u[0],f=u[1],v=Object(r.useState)(g.NONE),y=Object(d.a)(v,2),w=y[0],k=y[1],b=Object(r.useState)(null),x=Object(d.a)(b,2),M=x[0],A=x[1],R=Object(r.useState)([]),C=Object(d.a)(R,2),D=(C[0],C[1],function(){var n=Object(c.a)(l.a.mark((function n(){var t,r,i,o,u,c;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=null,r=e.current?e.current.getValue():null){n.next=4;break}return n.abrupt("return",!1);case 4:return i="".concat(I,"/workflow/",1,"/run"),n.next=7,h.a.post(i,{yaml:r}).catch((function(e){return t=e}));case 7:if((o=n.sent)&&!t){n.next=11;break}return j(t),n.abrupt("return",!1);case 11:return s(null),E(o),o.data.status===a.success?(null===(u=o.data.data)||void 0===u?void 0:u.length)&&(c=o.data.data[0])&&(A(c),F(c.runId,c.workflowId),k(g.RUNNING)):(o.data.status,a.fail),n.abrupt("return",!0);case 15:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()),W=function(){var e=Object(c.a)(l.a.mark((function e(){var n,t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M){e.next=2;break}return e.abrupt("return",!1);case 2:return n=null,t="".concat(I,"/workflow/").concat(M.workflowId,"/").concat(M.runId,"/terminate"),"FROM UI",e.next=7,h.a.post(t,{reason:"FROM UI"}).catch((function(e){return n=e}));case 7:if((r=e.sent)&&!n){e.next=11;break}return j(n),e.abrupt("return",!1);case 11:return E(r),r.data.status===a.success||(r.data.status,a.fail),e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(c.a)(l.a.mark((function e(n,t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_(n,t),L(n,t),a=setInterval((function(){_(n,t),L(n,t),S!==g.RUNNING?clearInterval(a):console.log(w)}),1e3);case 3:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),_=function(){var e=Object(c.a)(l.a.mark((function e(n,t){var r,i,o,u,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,i="".concat(I,"/workflow/").concat(t,"/").concat(n,"/history"),e.next=4,h.a.get(i).catch((function(e){return r=e}));case 4:if((o=e.sent)&&!r){e.next=8;break}return j(r),e.abrupt("return",!1);case 8:return o.data.status===a.success&&(null===(u=o.data.data)||void 0===u?void 0:u.length)&&(c=o.data.data[0])&&s(c),e.abrupt("return");case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),L=function(){var e=Object(c.a)(l.a.mark((function e(n,t){var r,i,s,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,i="".concat(I,"/workflow/").concat(t,"/").concat(n,"/status"),e.next=4,h.a.get(i).catch((function(e){return r=e}));case 4:if((s=e.sent)&&!r){e.next=8;break}return j(r),e.abrupt("return",!1);case 8:return s.data.status===a.success&&(null===(o=s.data.data)||void 0===o?void 0:o.length)&&(u=s.data.data[0])&&(f(u),"Running"===u.workflowExecutionInfo.status?(k(g.RUNNING),S=g.RUNNING):"Terminated"===u.workflowExecutionInfo.status?(k(g.TERMINATED),S=g.TERMINATED):"Completed"===u.workflowExecutionInfo.status?(k(g.COMPLETED),S=g.COMPLETED):"Failed"===u.workflowExecutionInfo.status?(k(g.FAILED),S=g.FAILED):console.error("Handle workflowExecutionInfo.status= "+u.workflowExecutionInfo.status)),e.abrupt("return");case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{className:"container mx-auto",children:[Object(O.jsxs)("div",{className:"grid grid-cols-3 text-center pt-1 pl-1",children:[Object(O.jsx)("select",{className:"col-span-2 bg-gray-500 text-white active:bg-pink-300 font-bold uppercase text-sm rounded shadow hover:shadow-lg outline-none focus:outline-none pl-4 mr-1 mb-1 ease-linear transition-all duration-150",onChange:function(n){if(e.current){var t=n.target.value,a=T.yamls;t<a.length&&e.current.setValue(a[t].code)}},children:T.yamls.map((function(e,n){return Object(O.jsx)("option",{value:n,children:e.name},n)}))}),w!==g.RUNNING&&Object(O.jsx)("button",{className:"col-span-1 bg-green-500 text-white active:bg-pink-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"button",onClick:D,children:"Run"}),w===g.RUNNING&&Object(O.jsx)("button",{className:"col-span-1 bg-pink-500 text-white active:bg-pink-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"button",onClick:W,children:"Terminate"})]}),Object(O.jsxs)("div",{className:"grid grid-cols-2",children:[Object(O.jsx)("div",{className:"container mx-auto",children:Object(O.jsx)(p.a,{options:{scrollbar:{vertical:"hidden"}},theme:"vs-dark",height:"100vh",defaultLanguage:"yaml",defaultValue:T.yamls[0].code,onMount:function(n,t){e.current=n}})}),Object(O.jsx)("div",{className:"container mx-auto p-0",children:Object(O.jsx)(N,{history:i,status:m})})]})]})},A=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,80)).then((function(n){var t=n.getCLS,a=n.getFID,r=n.getFCP,i=n.getLCP,s=n.getTTFB;t(e),a(e),r(e),i(e),s(e)}))};o.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(M,{})}),document.getElementById("root")),A()}},[[79,1,2]]]);
//# sourceMappingURL=main.80e1b3c4.chunk.js.map